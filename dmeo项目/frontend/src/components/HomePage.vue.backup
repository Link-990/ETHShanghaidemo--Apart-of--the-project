<template>
  <div class="homepage">
    <!-- é¡¶éƒ¨çŠ¶æ€æ  -->
    <div class="status-bar">
      <div class="status-item">
        <span class="status-label">è¿æ¥çŠ¶æ€:</span>
        <span :class="['status-value', isConnected ? 'connected' : 'disconnected']">
          {{ isConnected ? 'å·²è¿æ¥' : 'æœªè¿æ¥' }}
        </span>
      </div>
      <div class="status-item">
        <span class="status-label">å½“å‰åŒºå—:</span>
        <span class="status-value">{{ currentBlock || 'è·å–ä¸­...' }}</span>
      </div>
      <div class="status-item">
        <span class="status-label">ç½‘ç»œ:</span>
        <span class="status-value">{{ networkInfo.name }}</span>
      </div>
      <div class="status-item">
        <span class="status-label">RPC:</span>
        <span class="status-value">{{ currentRpcIndex + 1 }}/{{ HOLESKY_RPCS.length }}</span>
      </div>
    </div>

    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <div class="main-content">
      <!-- å·¦ä¾§ï¼šåŒºå—ä¿¡æ¯ -->
      <div class="left-panel">
        <div class="panel-header">
          <h3>å®æ—¶åŒºå—ä¿¡æ¯</h3>
          <div class="refresh-indicator" :class="{ active: isMonitoring }">
            <span class="dot"></span>
            {{ isMonitoring ? 'ç›‘æ§ä¸­' : 'å·²åœæ­¢' }}
          </div>
        </div>
        
        <div class="block-info" v-if="blockData">
          <div class="info-row">
            <span class="label">åŒºå—å·:</span>
            <span class="value">{{ blockData.number }}</span>
          </div>
          <div class="info-row">
            <span class="label">åŒºå—å“ˆå¸Œ:</span>
            <span class="value hash">{{ formatHash(blockData.hash) }}</span>
          </div>
          <div class="info-row">
            <span class="label">æ—¶é—´æˆ³:</span>
            <span class="value">{{ formatTime(blockData.timestamp) }}</span>
          </div>
          <div class="info-row">
            <span class="label">äº¤æ˜“æ•°é‡:</span>
            <span class="value">{{ blockData.transactionCount }}</span>
          </div>
          <div class="info-row">
            <span class="label">Gas ä½¿ç”¨:</span>
            <span class="value">{{ formatNumber(blockData.gasUsed) }} / {{ formatNumber(blockData.gasLimit) }}</span>
          </div>
          <div class="info-row">
            <span class="label">Gas ä»·æ ¼:</span>
            <span class="value">{{ blockData.gasPrice }} Gwei</span>
          </div>
          <div class="info-row">
            <span class="label">åŒºå—å¥–åŠ±:</span>
            <span class="value">{{ blockData.reward }} ETH</span>
          </div>
          <div class="info-row">
            <span class="label">åŒºå—æ—¶é—´:</span>
            <span class="value">{{ blockData.blockTime }}s</span>
          </div>
          <div class="info-row">
            <span class="label">TPS:</span>
            <span class="value">{{ blockData.tps }}</span>
          </div>
        </div>
        
        <div class="loading" v-else>
          <div class="spinner"></div>
          <span>æ­£åœ¨è·å–åŒºå—æ•°æ®...</span>
        </div>
      </div>

      <!-- å³ä¾§ï¼šäº¤æ˜“ç›‘æ§å’Œé£é™©åˆ†æ -->
      <div class="right-panel">
        <div class="panel-header">
          <h3>äº¤æ˜“é£é™©ç›‘æ§</h3>
          <div class="risk-stats">
            <div class="stat-item risk">
              <span class="count">{{ riskTransactions }}</span>
              <span class="label">é£é™©äº¤æ˜“</span>
            </div>
            <div class="stat-item blocked">
              <span class="count">{{ blockedTransactions }}</span>
              <span class="label">å·²æ‹¦æˆª</span>
            </div>
          </div>
        </div>

        <!-- äº¤æ˜“åˆ—è¡¨ -->
        <div class="transaction-list">
          <div class="list-header">
            <span class="col-hash">äº¤æ˜“å“ˆå¸Œ</span>
            <span class="col-from">å‘é€æ–¹</span>
            <span class="col-to">æ¥æ”¶æ–¹</span>
            <span class="col-value">é‡‘é¢</span>
            <span class="col-risk">é£é™©è¯„åˆ†</span>
            <span class="col-time">æ—¶é—´</span>
          </div>
          
          <div class="transaction-item" 
               v-for="tx in displayTransactions" 
               :key="tx.hash"
               :class="{ 'high-risk': tx.riskScore >= 70, 'blocked': tx.riskScore >= 90 }">
            <span class="col-hash">{{ formatHash(tx.hash) }}</span>
            <span class="col-from">{{ formatAddress(tx.from) }}</span>
            <span class="col-to">{{ formatAddress(tx.to) }}</span>
            <span class="col-value">{{ formatEther(tx.value) }} ETH</span>
            <span class="col-risk" :class="getRiskClass(tx.riskScore)">{{ tx.riskScore }}</span>
            <span class="col-time">{{ formatTimeAgo(tx.timestamp) }}</span>
          </div>
          
          <div class="no-transactions" v-if="displayTransactions.length === 0">
            <span>æš‚æ— äº¤æ˜“æ•°æ®</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref, onMounted, onUnmounted } from 'vue'
import Web3 from 'web3'

// å“åº”å¼æ•°æ®
const isConnected = ref(false)
const isMonitoring = ref(false)
const currentBlock = ref(null)
const blockData = ref(null)
const displayTransactions = ref([])
const riskTransactions = ref(0)
const blockedTransactions = ref(0)

// å®šæ—¶å™¨
let blockMonitorTimer = null
let statsTimer = null

// ç½‘ç»œé…ç½®
const networkInfo = ref({
  name: 'Holesky Testnet',
  chainId: 17000
})

// å¤šä¸ª Holesky RPC ç«¯ç‚¹ï¼Œæé«˜è¿æ¥ç¨³å®šæ€§
const HOLESKY_RPCS = [
  'https://ethereum-holesky-rpc.publicnode.com',
  'https://holesky.drpc.org',
  'https://ethereum-holesky.publicnode.com',
  'https://holesky.gateway.tenderly.co',
  'https://1rpc.io/holesky'
]

let currentRpcIndex = ref(0)
let web3 = null

// åˆå§‹åŒ–è¿æ¥
const initializeConnection = async () => {
  console.log('ğŸ”„ æ­£åœ¨åˆå§‹åŒ–åŒºå—é“¾è¿æ¥...')
  
  // å°è¯•è¿æ¥åˆ°å¯ç”¨çš„ RPC ç«¯ç‚¹ï¼Œæ¯ä¸ªç«¯ç‚¹æœ€å¤šé‡è¯•2æ¬¡
  for (let attempt = 0; attempt < 2; attempt++) {
    for (let i = 0; i < HOLESKY_RPCS.length; i++) {
      const rpcUrl = HOLESKY_RPCS[i]
      console.log(`ğŸ”— å°è¯•è¿æ¥åˆ° RPC ${i + 1}/${HOLESKY_RPCS.length}: ${rpcUrl}`)
      
      try {
        // è®¾ç½®è¿æ¥è¶…æ—¶
        const timeoutPromise = new Promise((_, reject) => 
          setTimeout(() => reject(new Error('è¿æ¥è¶…æ—¶')), 5000)
        )
        
        const connectPromise = (async () => {
          web3 = new Web3(rpcUrl)
          const blockNumber = await web3.eth.getBlockNumber()
          return blockNumber
        })()
        
        const blockNumber = await Promise.race([connectPromise, timeoutPromise])
        
        currentRpcIndex.value = i
        currentBlock.value = Number(blockNumber)
        isConnected.value = true
        
        console.log(`âœ… æˆåŠŸè¿æ¥åˆ° Holesky ç½‘ç»œ! å½“å‰åŒºå—: ${blockNumber}`)
        console.log(`ğŸ“¡ ä½¿ç”¨ RPC: ${rpcUrl}`)
        
        return true
      } catch (error) {
        console.warn(`âš ï¸ RPC ${i + 1} è¿æ¥å¤±è´¥:`, error.message)
        web3 = null
        isConnected.value = false
      }
    }
  }
  
  console.error('âŒ æ‰€æœ‰ RPC ç«¯ç‚¹è¿æ¥å¤±è´¥ï¼Œ10ç§’åé‡è¯•...')
  setTimeout(() => {
    initializeConnection()
  }, 10000)
  
  return false
}

// åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ª RPC ç«¯ç‚¹
const switchRpcEndpoint = () => {
  currentRpcIndex.value = (currentRpcIndex.value + 1) % HOLESKY_RPCS.length
  console.log(`ğŸ”„ åˆ‡æ¢åˆ° RPC ${currentRpcIndex.value + 1}/${HOLESKY_RPCS.length}`)
}

// å¼€å§‹åŒºå—ç›‘æ§
const startBlockMonitoring = async () => {
  if (!isConnected.value || !web3) {
    console.warn('âš ï¸ æœªè¿æ¥åˆ°ç½‘ç»œï¼Œæ— æ³•å¼€å§‹ç›‘æ§')
    return
  }
  
  isMonitoring.value = true
  console.log('ğŸ¯ å¼€å§‹åŒºå—ç›‘æ§...')
  
  const monitorBlocks = async () => {
    try {
      // è®¾ç½®è¶…æ—¶æ—¶é—´
      const timeoutPromise = new Promise((_, reject) => 
        setTimeout(() => reject(new Error('è·å–åŒºå—å·è¶…æ—¶')), 3000)
      )
      
      const blockPromise = web3.eth.getBlockNumber()
      const latestBlock = await Promise.race([blockPromise, timeoutPromise])
      
      if (Number(latestBlock) !== currentBlock.value) {
        currentBlock.value = Number(latestBlock)
        await fetchBlockData(latestBlock)
      }
    } catch (error) {
      console.warn('âš ï¸ åŒºå—ç›‘æ§å‡ºé”™:', error.message)
      isConnected.value = false
      
      // å°è¯•åˆ‡æ¢ RPC å¹¶é‡æ–°è¿æ¥
      setTimeout(async () => {
        switchRpcEndpoint()
        await initializeConnection()
      }, 2000)
    }
  }
  
  // ç«‹å³æ‰§è¡Œä¸€æ¬¡
  await monitorBlocks()
  
  // è®¾ç½®å®šæ—¶ç›‘æ§ï¼ˆè°ƒæ•´ä¸º2ç§’é—´éš”ï¼Œå‡å°‘ç½‘ç»œå‹åŠ›ï¼‰
  blockMonitorTimer = setInterval(monitorBlocks, 2000)
}

// è·å–åŒºå—æ•°æ®
const fetchBlockData = async (blockNumber) => {
  try {
    console.log(`ğŸ“¦ è·å–åŒºå— ${blockNumber} çš„è¯¦ç»†ä¿¡æ¯...`)
    
    const [block, prevBlock] = await Promise.all([
      web3.eth.getBlock(blockNumber, true),
      blockNumber > 0 ? web3.eth.getBlock(blockNumber - 1, false) : null
    ])
    
    if (block) {
      // å®‰å…¨åœ°å¤„ç† BigInt è½¬æ¢
      const blockTime = prevBlock ? 
        Number(block.timestamp) - Number(prevBlock.timestamp) : 0
      
      // è®¡ç®— TPS
      const tps = blockTime > 0 ? (block.transactions.length / blockTime).toFixed(2) : '0.00'
      
      // è·å– Gas ä»·æ ¼ (è½¬æ¢ä¸º Gwei)
      const gasPriceWei = block.baseFeePerGas || 0n
      const gasPriceGwei = web3.utils.fromWei(String(gasPriceWei), 'gwei')
      
      blockData.value = {
        number: Number(block.number),
        hash: block.hash,
        timestamp: Number(block.timestamp) * 1000, // è½¬æ¢ä¸ºæ¯«ç§’
        transactionCount: block.transactions.length,
        gasUsed: Number(block.gasUsed),
        gasLimit: Number(block.gasLimit),
        gasPrice: parseFloat(gasPriceGwei).toFixed(2),
        reward: calculateBlockReward(block),
        blockTime: blockTime,
        tps: tps
      }
      
      // å¤„ç†äº¤æ˜“æ•°æ®
      if (block.transactions && block.transactions.length > 0) {
        await processRealTransactions(block.transactions)
      }
      
      console.log(`âœ… åŒºå— ${blockNumber} æ•°æ®æ›´æ–°å®Œæˆ`)
    }
  } catch (error) {
    console.error('âŒ è·å–åŒºå—æ•°æ®å¤±è´¥:', error)
  }
}

// è®¡ç®—åŒºå—å¥–åŠ±
const calculateBlockReward = (block) => {
  try {
    // Holesky æµ‹è¯•ç½‘çš„åŸºç¡€å¥–åŠ±çº¦ä¸º 2 ETH
    const baseReward = 2.0
    
    // æ ¹æ® Gas ä½¿ç”¨ç‡è°ƒæ•´å¥–åŠ±
    const gasUsed = Number(block.gasUsed)
    const gasLimit = Number(block.gasLimit)
    const gasUtilization = gasUsed / gasLimit
    
    // ç®€å•çš„å¥–åŠ±è®¡ç®—æ¨¡å‹
    const reward = baseReward * (1 + gasUtilization * 0.1)
    
    return reward.toFixed(4)
  } catch (error) {
    console.warn('âš ï¸ è®¡ç®—åŒºå—å¥–åŠ±å¤±è´¥:', error)
    return '2.0000'
  }
}

// å¤„ç†çœŸå®äº¤æ˜“æ•°æ®
const processRealTransactions = async (transactions) => {
  const processedCount = Math.min(transactions.length, 3) // é™åˆ¶å¤„ç†æ•°é‡ï¼Œé¿å…è¿‡å¤šè¯·æ±‚
  
  for (let i = 0; i < processedCount; i++) {
    const txHash = transactions[i]
    try {
      // éªŒè¯ txHash æ˜¯å¦ä¸ºæœ‰æ•ˆå­—ç¬¦ä¸²
      if (!txHash || typeof txHash !== 'string') {
        console.warn('âš ï¸ æ— æ•ˆçš„äº¤æ˜“å“ˆå¸Œ:', txHash)
        continue
      }
      
      // è®¾ç½®è¶…æ—¶æ—¶é—´
      const timeoutPromise = new Promise((_, reject) => 
        setTimeout(() => reject(new Error('è·å–äº¤æ˜“è¯¦æƒ…è¶…æ—¶')), 2000)
      )
      
      const txPromise = web3.eth.getTransaction(txHash)
      const tx = await Promise.race([txPromise, timeoutPromise])
      
      if (tx) {
        const riskScore = calculateRiskScore(tx)
        const processedTx = {
          hash: tx.hash,
          from: tx.from,
          to: tx.to || '0x0000000000000000000000000000000000000000', // åˆçº¦åˆ›å»ºäº¤æ˜“
          value: tx.value,
          riskScore: riskScore,
          timestamp: Date.now() // ä½¿ç”¨å½“å‰æ—¶é—´ä½œä¸ºå¤„ç†æ—¶é—´
        }
        
        // æ·»åŠ åˆ°æ˜¾ç¤ºåˆ—è¡¨ï¼ˆæœ€å¤šæ˜¾ç¤º20æ¡ï¼‰
        displayTransactions.value.unshift(processedTx)
        if (displayTransactions.value.length > 20) {
          displayTransactions.value.pop()
        }
        
        // æ›´æ–°é£é™©ç»Ÿè®¡
        if (riskScore >= 70) {
          riskTransactions.value++
          if (riskScore >= 90) {
            blockedTransactions.value++
          }
        }
      }
    } catch (txError) {
      // å®‰å…¨åœ°å¤„ç† txHashï¼Œé˜²æ­¢ slice é”™è¯¯
      const hashDisplay = (txHash && typeof txHash === 'string' && txHash.length >= 10) 
        ? `${txHash.slice(0, 10)}...` 
        : String(txHash || 'unknown')
      console.warn(`âš ï¸ è·å–äº¤æ˜“è¯¦æƒ…å¤±è´¥ (${hashDisplay}):`, txError.message)
      // å¦‚æœè·å–å¤±è´¥ï¼Œç»§ç»­å¤„ç†ä¸‹ä¸€ä¸ªäº¤æ˜“
      continue
    }
    
    // åœ¨å¤„ç†ä¹‹é—´æ·»åŠ å°å»¶è¿Ÿï¼Œé¿å…è¯·æ±‚è¿‡äºé¢‘ç¹
    if (i < processedCount - 1) {
      await new Promise(resolve => setTimeout(resolve, 100))
    }
  }
}

// æ¨¡æ‹Ÿäº¤æ˜“æ•°æ®ï¼ˆå½“æ²¡æœ‰çœŸå®äº¤æ˜“æ—¶ä½¿ç”¨ï¼‰
const generateMockTransaction = () => {
  const mockAddresses = [
    '0x742d35Cc6634C0532925a3b8D4C9db4C4C4C4C4C',
    '0x8ba1f109551bD432803012645Hac136c22C4C4C4',
    '0x123456789abcdef123456789abcdef123456789a',
    '0xabcdef123456789abcdef123456789abcdef12345'
  ]
  
  const randomValue = Math.random() * 10 // 0-10 ETH
  const riskScore = calculateRiskScore({
    value: web3.utils.toWei(randomValue.toString(), 'ether'),
    from: mockAddresses[Math.floor(Math.random() * mockAddresses.length)],
    to: mockAddresses[Math.floor(Math.random() * mockAddresses.length)]
  })
  
  return {
    hash: '0x' + Math.random().toString(16).substr(2, 64),
    from: mockAddresses[Math.floor(Math.random() * mockAddresses.length)],
    to: mockAddresses[Math.floor(Math.random() * mockAddresses.length)],
    value: web3.utils.toWei(randomValue.toString(), 'ether'),
    riskScore: riskScore,
    timestamp: Date.now()
  }
}

// è®¡ç®—é£é™©è¯„åˆ†
const calculateRiskScore = (tx) => {
  let riskScore = 0
  
  try {
    // åŸºäºäº¤æ˜“é‡‘é¢çš„é£é™©è¯„ä¼°
    const valueInEth = parseFloat(web3.utils.fromWei(String(tx.value), 'ether'))
    
    if (valueInEth > 100) riskScore += 40
    else if (valueInEth > 10) riskScore += 20
    else if (valueInEth > 1) riskScore += 10
    
    // åŸºäºåœ°å€æ¨¡å¼çš„é£é™©è¯„ä¼°
    const fromAddr = tx.from?.toLowerCase() || ''
    const toAddr = tx.to?.toLowerCase() || ''
    
    // æ£€æŸ¥æ˜¯å¦ä¸ºæ–°åœ°å€æˆ–å¯ç–‘æ¨¡å¼
    if (fromAddr.includes('000000') || toAddr.includes('000000')) {
      riskScore += 15
    }
    
    // æ£€æŸ¥æ˜¯å¦ä¸ºåˆçº¦åˆ›å»ºäº¤æ˜“
    if (!tx.to || tx.to === '0x0000000000000000000000000000000000000000') {
      riskScore += 25
    }
    
    // æ·»åŠ ä¸€äº›éšæœºæ€§æ¥æ¨¡æ‹Ÿå¤æ‚çš„é£é™©åˆ†æ
    riskScore += Math.floor(Math.random() * 30)
    
    return Math.min(riskScore, 100)
  } catch (error) {
    console.warn('âš ï¸ è®¡ç®—é£é™©è¯„åˆ†å¤±è´¥:', error)
    return Math.floor(Math.random() * 50) // è¿”å›ä¸€ä¸ªè¾ƒä½çš„éšæœºé£é™©è¯„åˆ†
  }
}

// æ ¼å¼åŒ–å‡½æ•°
const formatEther = (value) => {
  try {
    if (!value) return '0.0000'
    const ethValue = web3.utils.fromWei(String(value), 'ether')
    return parseFloat(ethValue).toFixed(4)
  } catch (error) {
    console.warn('âš ï¸ æ ¼å¼åŒ– Ether å¤±è´¥:', error)
    return '0.0000'
  }
}

const formatNumber = (num) => {
  if (!num) return '0'
  return Number(num).toLocaleString()
}

const formatHash = (hash) => {
  if (!hash) return ''
  return `${hash.slice(0, 10)}...${hash.slice(-8)}`
}

const formatAddress = (address) => {
  if (!address) return ''
  return `${address.slice(0, 8)}...${address.slice(-6)}`
}

const formatTime = (timestamp) => {
  if (!timestamp) return ''
  return new Date(timestamp).toLocaleString('zh-CN')
}

const formatTimeAgo = (timestamp) => {
  if (!timestamp) return ''
  const now = Date.now()
  const diff = now - timestamp
  const seconds = Math.floor(diff / 1000)
  
  if (seconds < 60) return `${seconds}ç§’å‰`
  if (seconds < 3600) return `${Math.floor(seconds / 60)}åˆ†é’Ÿå‰`
  if (seconds < 86400) return `${Math.floor(seconds / 3600)}å°æ—¶å‰`
  return `${Math.floor(seconds / 86400)}å¤©å‰`
}

const getRiskClass = (score) => {
  if (score >= 90) return 'blocked'
  if (score >= 70) return 'high-risk'
  if (score >= 40) return 'medium-risk'
  return 'low-risk'
}

// ç”Ÿå‘½å‘¨æœŸ
onMounted(async () => {
  console.log('ğŸš€ DeFi é£é™©ç›‘æ§ç³»ç»Ÿå¯åŠ¨ä¸­...')
  
  // åˆå§‹åŒ–è¿æ¥
  const connected = await initializeConnection()
  
  if (connected) {
    // å¼€å§‹ç›‘æ§
    await startBlockMonitoring()
    
    // å¯åŠ¨ç»Ÿè®¡å®šæ—¶å™¨
    statsTimer = setInterval(() => {
      // è¿™é‡Œå¯ä»¥æ·»åŠ å®šæœŸç»Ÿè®¡æ›´æ–°é€»è¾‘
    }, 5000)
  }
})

onUnmounted(() => {
  console.log('ğŸ›‘ åœæ­¢ç›‘æ§æœåŠ¡...')
  
  if (blockMonitorTimer) {
    clearInterval(blockMonitorTimer)
  }
  
  if (statsTimer) {
    clearInterval(statsTimer)
  }
  
  isMonitoring.value = false
  isConnected.value = false
})
</script>

<style scoped>
.homepage {
  min-height: 100vh;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  padding: 20px;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

.status-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  border-radius: 15px;
  padding: 15px 25px;
  margin-bottom: 25px;
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.status-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 5px;
}

.status-label {
  font-size: 12px;
  color: rgba(255, 255, 255, 0.7);
  font-weight: 500;
}

.status-value {
  font-size: 14px;
  font-weight: 600;
  color: white;
}

.status-value.connected {
  color: #4ade80;
}

.status-value.disconnected {
  color: #f87171;
}

.main-content {
  display: grid;
  grid-template-columns: 1fr 2fr;
  gap: 25px;
  height: calc(100vh - 140px);
}

.left-panel, .right-panel {
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  border-radius: 20px;
  padding: 25px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  overflow: hidden;
}

.panel-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 25px;
  padding-bottom: 15px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.2);
}

.panel-header h3 {
  color: white;
  font-size: 18px;
  font-weight: 600;
  margin: 0;
}

.refresh-indicator {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 12px;
  color: rgba(255, 255, 255, 0.7);
}

.refresh-indicator .dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: #f87171;
}

.refresh-indicator.active .dot {
  background: #4ade80;
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

.block-info {
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.info-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 15px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 10px;
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.info-row .label {
  font-size: 13px;
  color: rgba(255, 255, 255, 0.7);
  font-weight: 500;
}

.info-row .value {
  font-size: 13px;
  color: white;
  font-weight: 600;
  text-align: right;
}

.info-row .value.hash {
  font-family: 'Courier New', monospace;
  font-size: 11px;
}

.loading {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 200px;
  gap: 15px;
  color: rgba(255, 255, 255, 0.7);
}

.spinner {
  width: 40px;
  height: 40px;
  border: 3px solid rgba(255, 255, 255, 0.3);
  border-top: 3px solid white;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.risk-stats {
  display: flex;
  gap: 20px;
}

.stat-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 5px;
}

.stat-item .count {
  font-size: 20px;
  font-weight: 700;
}

.stat-item .label {
  font-size: 11px;
  color: rgba(255, 255, 255, 0.7);
}

.stat-item.risk .count {
  color: #fbbf24;
}

.stat-item.blocked .count {
  color: #f87171;
}

.transaction-list {
  height: calc(100% - 80px);
  overflow-y: auto;
}

.list-header {
  display: grid;
  grid-template-columns: 1.5fr 1fr 1fr 0.8fr 0.6fr 0.8fr;
  gap: 10px;
  padding: 12px 15px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 10px;
  margin-bottom: 15px;
  font-size: 11px;
  font-weight: 600;
  color: rgba(255, 255, 255, 0.8);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.transaction-item {
  display: grid;
  grid-template-columns: 1.5fr 1fr 1fr 0.8fr 0.6fr 0.8fr;
  gap: 10px;
  padding: 12px 15px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 8px;
  margin-bottom: 8px;
  font-size: 11px;
  color: white;
  border: 1px solid rgba(255, 255, 255, 0.1);
  transition: all 0.3s ease;
}

.transaction-item:hover {
  background: rgba(255, 255, 255, 0.1);
  transform: translateY(-1px);
}

.transaction-item.high-risk {
  border-left: 4px solid #fbbf24;
  background: rgba(251, 191, 36, 0.1);
}

.transaction-item.blocked {
  border-left: 4px solid #f87171;
  background: rgba(248, 113, 113, 0.1);
}

.col-hash, .col-from, .col-to {
  font-family: 'Courier New', monospace;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.col-risk {
  text-align: center;
  font-weight: 600;
}

.col-risk.low-risk { color: #4ade80; }
.col-risk.medium-risk { color: #fbbf24; }
.col-risk.high-risk { color: #fb923c; }
.col-risk.blocked { color: #f87171; }

.col-value, .col-time {
  text-align: right;
}

.no-transactions {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 200px;
  color: rgba(255, 255, 255, 0.5);
  font-style: italic;
}

/* æ»šåŠ¨æ¡æ ·å¼ */
.transaction-list::-webkit-scrollbar {
  width: 6px;
}

.transaction-list::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 3px;
}

.transaction-list::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.3);
  border-radius: 3px;
}

.transaction-list::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.5);
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 1200px) {
  .main-content {
    grid-template-columns: 1fr;
    gap: 20px;
  }
  
  .status-bar {
    flex-wrap: wrap;
    gap: 15px;
  }
}

@media (max-width: 768px) {
  .homepage {
    padding: 15px;
  }
  
  .status-bar {
    padding: 15px;
  }
  
  .left-panel, .right-panel {
    padding: 20px;
  }
  
  .list-header, .transaction-item {
    grid-template-columns: 1fr;
    gap: 5px;
  }
  
  .list-header span, .transaction-item span {
    padding: 2px 0;
  }
}
</style>